{% extends "base.html" %}

{% block content %}
<div class="container my-5">
    <!-- Stock Title, Ticker, and Logo -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="display-4">{{ stock_name }} <small class="text-muted">({{ ticker }})</small></h1>
        <img src="{{ logo_url }}" alt="{{ stock_name }} Logo" class="img-fluid" style="max-height: 80px;">
    </div>

    <!-- Section 1: Investment Recommendation -->
    <div class="p-4 mb-5 shadow-lg" style="background-color: #f8f9fa; border-radius: 8px;">
        <h2 class="mb-4">Investment Recommendation</h2>
        <div class="row">
            <div class="col-md-4 text-center">
                <div>
                    <p class="small-text">Current Price</p>
                    <p class="highlighted-number">${{ analysis_data.last_closing_price | int }}</p>
                </div>
            </div>
            <div class="col-md-4 text-center">
                <div>
                    <p class="small-text">Price Target</p>
                    <p class="highlighted-number">${{ analysis_data.avg_combined_criteria | int }}</p>
                </div>
            </div>
            <div class="col-md-4 text-center">
                <div>
                    <p class="small-text">Expected Return</p>
                    <p class="highlighted-number">{{ analysis_data.expected_return_combined_criteria | int }}%</p>
                </div>
            </div>
        </div>
        <div class="text-center mt-4">
            {% if stock_in_portfolio %}
                <button class="btn btn-success btn-lg px-5">BUY</button>
            {% else %}
                <button class="btn btn-danger btn-lg px-5">SELL</button>
            {% endif %}
        </div>
    </div>

    <!-- Section 2: Company Analysis (SWOT with compact questions layout) -->
    <div class="mb-5">
        <h2 class="mb-4">Company Analysis</h2>

        <!-- Strengths -->
        <div class="mb-4">
            <h4>Strengths</h4>
            <div class="row">
                {% for report in swot_reports.strengths %}
                <div class="col-md-4 mb-3">
                    <a href="{{ url_for('view_answer', question_id=report.id) }}" class="swot-link">
                        {{ report.question }}
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Weaknesses -->
        <div class="mb-4">
            <h4>Weaknesses</h4>
            <div class="row">
                {% for report in swot_reports.weaknesses %}
                <div class="col-md-4 mb-3">
                    <a href="{{ url_for('view_answer', question_id=report.id) }}" class="swot-link">
                        {{ report.question }}
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Opportunities -->
        <div class="mb-4">
            <h4>Opportunities</h4>
            <div class="row">
                {% for report in swot_reports.opportunities %}
                <div class="col-md-4 mb-3">
                    <a href="{{ url_for('view_answer', question_id=report.id) }}" class="swot-link">
                        {{ report.question }}
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Risks -->
        <div class="mb-4">
            <h4>Risks</h4>
            <div class="row">
                {% for report in swot_reports.threats %}
                <div class="col-md-4 mb-3">
                    <a href="{{ url_for('view_answer', question_id=report.id) }}" class="swot-link">
                        {{ report.question }}
                    </a>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
