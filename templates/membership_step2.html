{% extends "base.html" %}

{% block title %}Join Good Life Pro - Payment{% endblock %}

{% block content %}
<div class="container text-center my-5">
    <h1 class="display-4">Complete Your Payment</h1>
    <p class="lead mt-4">Unlock premium features and start making smarter investment decisions.</p>

    <!-- The Paddle checkout form will be embedded here -->
    <div id="checkout-container" class="mt-5"></div>
</div>
{% endblock %}

{% block custom_scripts %}
<script src="https://cdn.paddle.com/paddle/v2/paddle.js"></script>
<script type="text/javascript">
    // Set the environment, can be "sandbox" or "production"
    Paddle.Environment.set("sandbox");  // Use "production" when you're ready to go live

    // Initialize Paddle with your client-side token
    Paddle.Initialize({
        token: "test_a5cb9a6d57e6495b160b60658fc"  // Replace with your actual client-side token
    });

    // Setup Paddle with your Vendor ID
    Paddle.Setup({ vendor: 22225 });  // Replace with your Paddle Vendor ID

    // Open Paddle Checkout in an inline frame
    Paddle.Checkout.open({
        product: 'pro_01j64xprc12a5ngkskpnrwpteq',  // Replace with your Paddle Product ID
        email: "{{ current_user.email }}",  // Pre-fill the user's email
        passthrough: JSON.stringify({
            user_id: "{{ current_user.id }}"  // Send the user ID as passthrough data
        }),
        method: 'inline',  // Use inline method
        frameTarget: 'checkout-container',  // Embed the checkout in this div
        frameInitialHeight: 415,
        frameStyle: 'width:100%; min-width:300px; max-width:600px; border:none; background-color:none;',
    });
</script>
{% endblock %}
