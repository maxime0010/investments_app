{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}



    <div class="container">
        <h1>Welcome to Your Dashboard</h1>
        <p id="accountInfo">Fetching account details...</p>

        <h2>Actions</h2>
        <ul>
            <li><a id="fundAccountLink" href="#">Fund Your Account</a></li>
            <li><a id="startTradingLink" href="#">Start Trading</a></li>
            <li><a id="viewAccountDetailsLink" href="#">View Account Details</a></li>
        </ul>
    </div>

    <script>
        // Fetch query parameters
        const urlParams = new URLSearchParams(window.location.search);
        const accountId = urlParams.get('account_id');

        // Fetch and display account details
        async function fetchAccountDetails() {
            const accountInfoElement = document.getElementById('accountInfo');
            try {
                const response = await fetch(`/api/accounts/${accountId}`);
                if (response.ok) {
                    const account = await response.json();
                    accountInfoElement.innerHTML = `
                        <p><strong>Account Number:</strong> ${account.account_number}</p>
                        <p><strong>Status:</strong> ${account.status}</p>
                        <p><strong>Currency:</strong> ${account.currency}</p>
                        <p><strong>Created At:</strong> ${account.created_at}</p>
                    `;
                } else {
                    accountInfoElement.textContent = 'Failed to fetch account details.';
                }
            } catch (error) {
                console.error('Error fetching account details:', error);
                accountInfoElement.textContent = 'An error occurred while fetching account details.';
            }
        }

        // Set up links for actions
        document.getElementById('fundAccountLink').href = `/fund-account?account_id=${accountId}`;
        document.getElementById('startTradingLink').href = `/trading?account_id=${accountId}`;
        document.getElementById('viewAccountDetailsLink').href = `/account-details?account_id=${accountId}`;

        // Fetch account details on page load
        fetchAccountDetails();
    </script>


{% endblock %}
